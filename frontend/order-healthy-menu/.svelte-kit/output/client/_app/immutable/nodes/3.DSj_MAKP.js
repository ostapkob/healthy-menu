import{f as l,a as m}from"../chunks/CJeTjUBQ.js";import"../chunks/Bdv0iiYY.js";import{ac as k,af as y,ag as x,S as f,ad as q,b as n,P as b,ae as C,ah as J,ai as N,T as $,X as R,v as X,g}from"../chunks/wShWkVpQ.js";import{s as F,e as O}from"../chunks/DtUbhPAe.js";import{e as z,i as A}from"../chunks/B-ed5o8Q.js";import{i as B}from"../chunks/BWFvfl_G.js";import{i as S}from"../chunks/BwaiV4Aa.js";import{p as D,s as E,a as G}from"../chunks/BkLtfsHd.js";import{r as H,c as K,b as L}from"../chunks/DNx25qYt.js";var M=l('<div class="cart-item svelte-1hsbdxb"><span> </span> <button>Удалить</button></div>');function Q(s,c){k(c,!1);let t=D(c,"item",8);const d=()=>{H(t().id)};S();var o=M(),r=y(o),v=y(r);x(r);var p=f(r,2);x(o),q(u=>F(v,`${b(t()),n(()=>t().name)??""} x ${b(t()),n(()=>t().quantity)??""} = ${u??""} ₽`),[()=>(b(t()),n(()=>(t().price*t().quantity).toFixed(2)))]),O("click",p,d),m(s,o),C()}var U=l("<p>Корзина пуста</p>"),V=l("<!> <h3> </h3> <button>Оформить заказ</button>",1),W=l("<h1>Корзина</h1> <!>",1);function Y(s,c){k(c,!1);const t=()=>G(K,"$cart",d),[d,o]=E();let r=X(0);const v=async()=>{const a={user_id:1,items:t().map(i=>({dish_id:i.id,quantity:i.quantity}))};(await fetch("http://localhost:8001/orders/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(alert("Заказ оформлен!"),L()):alert("Ошибка при оформлении заказа")};J(()=>t(),()=>{R(r,t().reduce((a,e)=>a+e.price*e.quantity,0))}),N(),S();var p=W(),u=f($(p),2);{var T=a=>{var e=U();m(a,e)},P=a=>{var e=V(),i=$(e);z(i,1,t,A,(h,I)=>{Q(h,{get item(){return g(I)}})});var _=f(i,2),j=y(_);x(_);var w=f(_,2);q(h=>F(j,`Итого: ${h??""} ₽`),[()=>(g(r),n(()=>g(r).toFixed(2)))]),O("click",w,v),m(a,e)};B(u,a=>{t(),n(()=>t().length===0)?a(T):a(P,!1)})}m(s,p),C(),o()}function ct(s){Y(s,{})}export{ct as component};
