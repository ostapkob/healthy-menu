import{f as d,a as o,c as H}from"../chunks/Dexp1yiY.js";import"../chunks/ifL9KKwh.js";import{o as K}from"../chunks/D70PosjZ.js";import{p as L,s as b,f as D,a as Q,b as I,m as R,g as a,c as i,r as e,t as U}from"../chunks/sF-5qWL7.js";import{s as x,e as O}from"../chunks/DkO8GDoS.js";import{e as V,i as W}from"../chunks/D-PWps5L.js";import{i as y}from"../chunks/DP6b_pEU.js";import{i as X}from"../chunks/Ykzsoriz.js";var Y=d('<button class="bg-blue-500 text-white px-2 py-1">Забрал</button>'),Z=d('<button class="bg-green-500 text-white px-2 py-1">Доставлен</button>'),$=d('<tr><td class="border px-4 py-2"> </td><td class="border px-4 py-2"> </td><td class="border px-4 py-2"> </td><td class="border px-4 py-2"><!></td></tr>'),tt=d('<table class="min-w-full border"><thead><tr><th class="border px-4 py-2">ID доставки</th><th class="border px-4 py-2">ID заказа</th><th class="border px-4 py-2">Статус</th><th class="border px-4 py-2">Действия</th></tr></thead><tbody></tbody></table>'),at=d("<p>У вас нет активных доставок</p>"),st=d('<h2 class="text-xl font-bold mb-4">Мои доставки</h2> <!>',1);function nt(T,C){L(C,!1);let c=R([]);const J=1;K(async()=>{const t=await fetch(`http://localhost:8003/my-deliveries/${J}`);I(c,await t.json())});const g=async(t,s)=>{(await fetch(`http://localhost:8003/update-delivery-status/${t}?status=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})})).ok?I(c,a(c).map(l=>l.id===t?{...l,status:s}:l)):alert("Ошибка обновления статуса")};X();var k=st(),M=b(D(k),2);{var N=t=>{var s=tt(),m=b(i(s));V(m,5,()=>a(c),W,(l,r)=>{var f=$(),h=i(f),S=i(h,!0);e(h);var u=b(h),q=i(u,!0);e(u);var v=b(u),z=i(v,!0);e(v);var w=b(v),A=i(w);{var B=p=>{var n=Y();O("click",n,()=>g(a(r).id,"picked_up")),o(p,n)},E=p=>{var n=H(),F=D(n);{var G=_=>{var j=Z();O("click",j,()=>g(a(r).id,"delivered")),o(_,j)};y(F,_=>{a(r).status==="picked_up"&&_(G)},!0)}o(p,n)};y(A,p=>{a(r).status==="assigned"?p(B):p(E,!1)})}e(w),e(f),U(()=>{x(S,a(r).id),x(q,a(r).order_id),x(z,a(r).status)}),o(l,f)}),e(m),e(s),o(t,s)},P=t=>{var s=at();o(t,s)};y(M,t=>{a(c).length>0?t(N):t(P,!1)})}o(T,k),Q()}export{nt as component};
