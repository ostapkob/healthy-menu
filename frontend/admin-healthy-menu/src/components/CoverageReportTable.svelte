<script>
  export let items = [];
  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8001';

  const deleteItem = async (id) => {
    if (!confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?')) return;
    await fetch(`${API_BASE_URL}/dish-ingredients/${id}`, { method: 'DELETE' });
    window.location.reload(); // –∏–ª–∏ –æ–±–Ω–æ–≤–∏ —á–µ—Ä–µ–∑ store
  };
</script>

<div class="overflow-x-auto">
  <table class="table table-zebra w-full">
    <thead>
      <tr>
        <th>–ë–ª—é–¥–æ</th>
        <th>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</th>
        <th>–ì—Ä–∞–º–º—ã</th>
        <th class="w-24">–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      {#each items as item}
        <tr>
          <td>{item.dish?.name || item.dish_id}</td>
          <td>{item.ingredient?.name || item.ingredient_id}</td>
          <td>{item.amount_grams} –≥</td>
          <td>
            <button
              class="btn btn-ghost btn-xs text-error"
              on:click={() => deleteItem(item.id)}
            >
              üóëÔ∏è
            </button>
          </td>
        </tr>
      {/each}
    </tbody>
  </table>
</div>
