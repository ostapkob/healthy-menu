
 –§–∞–π–ª: src/app.css
@import 'tailwindcss';
@plugin '@tailwindcss/forms';
@plugin '@tailwindcss/typography';
@plugin "daisyui" {
  themes: all;
}


 –§–∞–π–ª: src/app.html
<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>


 –§–∞–π–ª: src/components/OrderCard.svelte
<!-- src/components/OrderCard.svelte -->
<script>
    import { courierId } from '../stores/courier.js';

    export let order;
    const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';

    let isAccepting = false; // –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

    const acceptOrder = async () => {
        isAccepting = true;

        // –ñ–¥—ë–º –ø–æ–ª—Å–µ–∫—É–Ω–¥—ã (500–º—Å) —Å –∞–∫—Ç–∏–≤–Ω—ã–º —Å–ø–∏–Ω–Ω–µ—Ä–æ–º
        await new Promise(resolve => setTimeout(resolve, 500));

        try {
            const response = await fetch(`${API_BASE_URL}/assign-delivery/`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    courier_id: $courierId,
                    order_id: order.id
                })
            });

            if (response.ok) {
                // alert('–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç');
                // window.location.reload(); // –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∑–∞–∫–∞–∑–∞');
            }
        } catch (e) {
            alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
        } finally {
            isAccepting = false;
        }
    };
</script>

<div class="border p-4 mb-2 rounded bg-base-100 shadow-sm">
    <p>–ó–∞–∫–∞–∑ #{order.id}</p>
    <p>–¶–µ–Ω–∞: {order.total_price} ‚ÇΩ</p>
    <p>–°—Ç–∞—Ç—É—Å: {order.status}</p>
    <button
        on:click={acceptOrder}
        class="btn btn-success btn-sm transition-all duration-150 active:scale-95 disabled:opacity-50"
        disabled={isAccepting}
        aria-label="–ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑"
    >
        {#if isAccepting}
            <span class="loading loading-spinner loading-xs"></span>
            –ü—Ä–∏–Ω–∏–º–∞—é...
        {:else}
            –ü—Ä–∏–Ω—è—Ç—å
        {/if}
    </button>
</div>


 –§–∞–π–ª: src/lib/assets/favicon.svg
<svg xmlns="http://www.w3.org/2000/svg" width="107" height="128" viewBox="0 0 107 128"><title>svelte-logo</title><path d="M94.157 22.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282 29.608A29.92 29.92 0 0 0 8.764 49.65a31.5 31.5 0 0 0 3.108 20.231 30 30 0 0 0-4.477 11.183 31.9 31.9 0 0 0 5.448 24.116c10.402 14.887 30.942 19.297 45.791 9.835l26.083-16.624A29.92 29.92 0 0 0 98.235 78.35a31.53 31.53 0 0 0-3.105-20.232 30 30 0 0 0 4.474-11.182 31.88 31.88 0 0 0-5.447-24.116" style="fill:#ff3e00"/><path d="M45.817 106.582a20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.503 18 18 0 0 1 .624-2.435l.49-1.498 1.337.981a33.6 33.6 0 0 0 10.203 5.098l.97.294-.09.968a5.85 5.85 0 0 0 1.052 3.878 6.24 6.24 0 0 0 6.695 2.485 5.8 5.8 0 0 0 1.603-.704L69.27 76.28a5.43 5.43 0 0 0 2.45-3.631 5.8 5.8 0 0 0-.987-4.371 6.24 6.24 0 0 0-6.698-2.487 5.7 5.7 0 0 0-1.6.704l-9.953 6.345a19 19 0 0 1-5.296 2.326 20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.502 17.99 17.99 0 0 1 8.13-12.052l26.081-16.623a19 19 0 0 1 5.3-2.329 20.72 20.72 0 0 1 22.237 8.243 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-.624 2.435l-.49 1.498-1.337-.98a33.6 33.6 0 0 0-10.203-5.1l-.97-.294.09-.968a5.86 5.86 0 0 0-1.052-3.878 6.24 6.24 0 0 0-6.696-2.485 5.8 5.8 0 0 0-1.602.704L37.73 51.72a5.42 5.42 0 0 0-2.449 3.63 5.79 5.79 0 0 0 .986 4.372 6.24 6.24 0 0 0 6.698 2.486 5.8 5.8 0 0 0 1.602-.704l9.952-6.342a19 19 0 0 1 5.295-2.328 20.72 20.72 0 0 1 22.237 8.242 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-8.13 12.053l-26.081 16.622a19 19 0 0 1-5.3 2.328" style="fill:#fff"/></svg>

 –§–∞–π–ª: src/lib/index.js
// place files you want to import through the `$lib` alias in this folder.


 –§–∞–π–ª: src/lib/theme.js
// src/lib/theme.js

import { writable } from 'svelte/store';

// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–µ–º—ã (—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å daisyUI)
const THEMES = ['light', 'dark', 'corporate', 'emerald', 'coffee', 'lemonade'];

// –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—É—é —Ç–µ–º—É
export const theme = writable(getStoredTheme());

function getStoredTheme() {
  if (typeof window === 'undefined') return 'lemonade'; // default –¥–ª—è –∞–¥–º–∏–Ω–∫–∏

  const saved = localStorage.getItem('theme');
  if (saved && THEMES.includes(saved)) return saved;

  if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
    return 'dark';
  }

  return 'corporate';
}

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
export function setTheme(newTheme) {
  if (!THEMES.includes(newTheme)) return;
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  theme.set(newTheme);
}

// –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–µ–º—É –±–µ–∑ –º–∏–≥–∞–Ω–∏—è
if (typeof window !== 'undefined') {
  setTheme(getStoredTheme());

  // –°–ª–µ–¥–∏–º –∑–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º–æ–π (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞)
  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
  const handleChange = (e) => {
    const saved = localStorage.getItem('theme');
    if (!saved || saved === 'light' || saved === 'dark') {
      setTheme(e.matches ? 'dark' : 'corporate');
    }
  };
  mediaQuery.addEventListener('change', handleChange);
}


 –§–∞–π–ª: src/routes/+layout.svelte
<script>
  import { base } from '$app/paths';
  import { theme, setTheme } from '$lib/theme.js';
  import { onMount } from 'svelte';
  import '../app.css'; 
  
  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';

  let mounted = false;
  let sidebarOpen = false;
  
  onMount(() => mounted = true);

  const toggleTheme = () => {
    const current = $theme;
    const next = current === 'lemonade' ? 'dark' : 'lemonade';
    setTheme(next);
  };

  const toggleSidebar = () => {
    sidebarOpen = !sidebarOpen;
  };

  // FIX –°—Ç–∞—Ç—É—Å –∫—É—Ä—å–µ—Ä–∞
  let courierStatus = 'offline';
  let courierName = '–ö—É—Ä—å–µ—Ä #1';
  let courierPhoto = null;

  onMount(async () => {
    const res = await fetch(`${API_BASE_URL}/couriers/1`);
    const data = await res.json();
    courierName = data.name;
    courierStatus = data.status;
    courierPhoto = data.photo_url;
  });
</script>

<div class="flex min-h-screen bg-base-100">
  <!-- Mobile Menu Overlay -->
  {#if sidebarOpen}
    <div 
      class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden" 
      on:click={toggleSidebar}
      aria-hidden="true"
    ></div>
  {/if}

  <!-- Sidebar -->
  <aside 
    class="fixed lg:static inset-y-0 left-0 z-50 w-64 bg-base-200 flex flex-col border-r border-base-300 transform transition-transform duration-300 ease-in-out lg:transform-none lg:transition-none {sidebarOpen ? 'translate-x-0' : '-translate-x-full'} lg:translate-x-0"
    role="navigation"
    aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è"
  >
    <!-- Mobile Close Button -->
    <button 
      class="lg:hidden absolute top-4 right-4 btn btn-ghost btn-circle btn-sm"
      on:click={toggleSidebar}
      aria-label="–ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- –®–∞–ø–∫–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º -->
    <div class="p-4 border-b border-base-300 flex items-center gap-3">
      <div class="avatar">
        <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
          {#if courierPhoto}
            <img src={courierPhoto} alt="–§–æ—Ç–æ –∫—É—Ä—å–µ—Ä–∞" class="w-full h-full object-cover rounded-full" />
          {:else}
            <svg xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              />
            </svg>
          {/if}
        </div>
      </div>

      <div class="flex-1 min-w-0">
        <div class="font-semibold text-sm truncate">{courierName}</div>
        <div class="text-xs mt-1">
          <span class={`badge badge-xs ${
            courierStatus === 'available' ? 'badge-success' :
            courierStatus === 'offline' ? 'badge-error' :
            'badge-warning'
          }`}>
            {courierStatus === 'available' ? 'üü¢ –û–Ω–ª–∞–π–Ω' :
             courierStatus === 'offline' ? 'üî¥ –û—Ñ–ª–∞–π–Ω' :
             'üü° –í –ø—É—Ç–∏'}
          </span>
        </div>
      </div>
    </div>

    <!-- –ú–µ–Ω—é -->
    <nav class="flex-1 p-4">
      <ul class="menu bg-base-200 space-y-2">
        <li>
          <a href="{base}/profile" class="flex items-center gap-3 py-3 px-4 rounded-lg hover:bg-base-300 transition-colors">
            <span class="text-lg">üë§</span>
            <span class="text-sm font-medium">–ü—Ä–æ—Ñ–∏–ª—å</span>
          </a>
        </li>
        <li>
          <a href="{base}/orders" class="flex items-center gap-3 py-3 px-4 rounded-lg hover:bg-base-300 transition-colors">
            <span class="text-lg">üì¶</span>
            <span class="text-sm font-medium">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã</span>
          </a>
        </li>
        <li>
          <a href="{base}/my-deliveries" class="flex items-center gap-3 py-3 px-4 rounded-lg hover:bg-base-300 transition-colors">
            <span class="text-lg">üöö</span>
            <span class="text-sm font-medium">–ú–æ–∏ –¥–æ—Å—Ç–∞–≤–∫–∏</span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Main content -->
  <div class="flex-1 flex flex-col min-w-0">
    <!-- Topbar -->
    <header class="navbar bg-base-200 border-b border-base-300 px-4 py-3">
      <div class="flex-1 flex items-center">
        <!-- Mobile Menu Button -->
        <button 
          class="lg:hidden btn btn-ghost btn-circle mr-2"
          on:click={toggleSidebar}
          aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é"
          aria-expanded={sidebarOpen}
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
        
        <div class="flex items-center gap-3">
          <div class="lg:hidden">
            <div class="avatar">
              <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
                {#if courierPhoto}
                  <img src={courierPhoto} alt="–§–æ—Ç–æ –∫—É—Ä—å–µ—Ä–∞" class="w-full h-full object-cover rounded-full" />
                {:else}
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                {/if}
              </div>
            </div>
          </div>
          
          <h1 class="text-lg md:text-xl font-semibold truncate">Courier Dashboard</h1>
        </div>
      </div>
      
      <div class="flex-none flex items-center gap-2">
        <!-- Mobile Status Badge -->
        <div class="lg:hidden">
          <span class={`badge badge-sm ${
            courierStatus === 'available' ? 'badge-success' :
            courierStatus === 'offline' ? 'badge-error' :
            'badge-warning'
          }`}>
            {courierStatus === 'available' ? 'üü¢' :
             courierStatus === 'offline' ? 'üî¥' :
             'üü°'}
          </span>
        </div>
        
        {#if mounted}
          <button 
            class="btn btn-ghost btn-square btn-sm md:btn-md" 
            on:click={toggleTheme} 
            aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
          >
            {#if $theme === 'dark'}
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
              </svg>
            {:else}
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414z" clip-rule="evenodd" />
              </svg>
            {/if}
          </button>
        {/if}
      </div>
    </header>

    <main class="flex-1 p-4 md:p-6 overflow-auto">
      <slot />
    </main>
  </div>
</div>

<style>
  /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é */
  aside {
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
  }
  
  /* –£–ª—É—á—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
  @media (max-width: 1023px) {
    aside {
      max-width: 85%;
    }
    
    main {
      -webkit-overflow-scrolling: touch;
    }
  }
  
  @media (max-width: 768px) {
    aside {
      max-width: 280px;
    }
  }
</style>


 –§–∞–π–ª: src/routes/+page.svelte
<h1 class="text-2xl font-bold">Courier Service</h1>
<p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é</p>


 –§–∞–π–ª: src/routes/couriers/+page.svelte
<script>
    import { onMount } from 'svelte';
    const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003'; // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è dev

    let couriers = [];

    onMount(async () => {
        const response = await fetch(`${API_BASE_URL}/couriers/`);
        couriers = await response.json();
    });
</script>

<h2 class="text-xl font-bold mb-4">–ö—É—Ä—å–µ—Ä—ã</h2>

<table class="min-w-full border">
    <thead>
        <tr>
            <th class="border px-4 py-2">ID</th>
            <th class="border px-4 py-2">–ò–º—è</th>
            <th class="border px-4 py-2">–°—Ç–∞—Ç—É—Å</th>
            <th class="border px-4 py-2">–¢–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑</th>
        </tr>
    </thead>
    <tbody>
        {#each couriers as courier}
        <tr>
            <td class="border px-4 py-2">{courier.id}</td>
            <td class="border px-4 py-2">{courier.name}</td>
            <td class="border px-4 py-2">{courier.status}</td>
            <td class="border px-4 py-2">{courier.current_order_id || '–ù–µ—Ç'}</td>
        </tr>
        {/each}
    </tbody>
</table>


 –§–∞–π–ª: src/routes/layout.css
@import 'tailwindcss';
@plugin '@tailwindcss/forms';
@plugin '@tailwindcss/typography';


 –§–∞–π–ª: src/routes/my-deliveries/+page.svelte
<!-- src/routes/my-deliveries/+page.svelte -->
<script>
  import { onMount } from 'svelte';

  let deliveries = [];
  const courierId = 1;
  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';

  onMount(async () => {
    const response = await fetch(`${API_BASE_URL}/my-deliveries/${courierId}`);
    deliveries = await response.json();
  });

  const updateStatus = async (deliveryId, newStatus) => {
    const response = await fetch(`${API_BASE_URL}/update-delivery-status/${deliveryId}?status=${newStatus}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ status: newStatus })
    });

    if (response.ok) {
      deliveries = deliveries.map(d =>
        d.id === deliveryId ? { ...d, status: newStatus } : d
      );
    } else {
      alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞');
    }
  };
</script>

<div>
  <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
    </svg>
    –ú–æ–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
  </h2>

  {#if deliveries.length > 0}
    <div class="overflow-x-auto">
      <table class="table table-zebra w-full">
        <thead>
          <tr>
            <th>–ó–∞–∫–∞–∑</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          {#each deliveries as delivery}
            <tr>
              <td>#{delivery.order_id}</td>
              <td>
                <span class={`badge ${
                  delivery.status === 'assigned' ? 'badge-warning' :
                  delivery.status === 'picked_up' ? 'badge-info' :
                  'badge-success'
                }`}>
                  {delivery.status}
                </span>
              </td>
              <td>
                {#if delivery.status === 'assigned'}
                  <button
                    class="btn btn-sm btn-primary"
                    on:click={() => updateStatus(delivery.id, 'picked_up')}
                  >
                    –ó–∞–±—Ä–∞–ª
                  </button>
                {:else if delivery.status === 'picked_up'}
                  <button
                    class="btn btn-sm btn-success"
                    on:click={() => updateStatus(delivery.id, 'delivered')}
                  >
                    –î–æ—Å—Ç–∞–≤–ª–µ–Ω
                  </button>
                {/if}
              </td>
            </tr>
          {/each}
        </tbody>
      </table>
    </div>
  {:else}
    <div class="text-center py-12">
      <p class="text-lg text-base-content/70">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–æ–∫</p>
    </div>
  {/if}
</div>


 –§–∞–π–ª: src/routes/orders/+page.svelte
<!-- src/routes/orders/+page.svelte -->
<script>
  import { onMount, onDestroy } from 'svelte';
  import OrderCard from '../../components/OrderCard.svelte';

  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';
  const WEB_SOCKET_URL = import.meta.env.VITE_WEB_SOCKET_URL || 'ws://localhost:8003';
  const courierId = 1;

  let orders = [];
  let ws = null;

  onMount(async () => {
    // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–∞–∫–∞–∑—ã
    const response = await fetch(`${API_BASE_URL}/available-orders/`);
    orders = await response.json();

    // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WebSocket
    ws = new WebSocket(`${WEB_SOCKET_URL}/ws/${courierId}`);

    ws.onopen = () => console.log('WebSocket connected');
    ws.onclose = () => console.log('WebSocket disconnected');

    ws.onmessage = async (event) => {
      const data = JSON.parse(event.data);

      if (data.type === 'new_order') {
        // üîÅ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º **–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞
        try {
          const orderRes = await fetch(`${API_BASE_URL}/available-orders/`);
          const allOrders = await orderRes.json();

          // –ù–∞—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ—è–≤–∏–≤—à–∏–π—Å—è –∑–∞–∫–∞–∑
          const newOrder = allOrders.find(o => o.id === data.order_id);

          if (newOrder) {
            orders = [newOrder, ...orders.filter(o => o.id !== newOrder.id)];
          }
        } catch (e) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞:', e);
        }
      } else if (data.type === 'order_assigned') {
        // –£–¥–∞–ª—è–µ–º –∑–∞–∫–∞–∑, –µ—Å–ª–∏ –µ–≥–æ –≤–∑—è–ª–∏
        orders = orders.filter(o => o.id !== data.order_id);
      }
    };
  });

  onDestroy(() => {
    if (ws) ws.close();
  });
</script>

<div>
  <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
    </svg>
    –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã
  </h2>

  <div class="mb-4">
    <span class="badge badge-info">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: {orders.length}</span>
  </div>

  {#if orders.length > 0}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {#each orders as order}
        <OrderCard {order} />
      {/each}
    </div>
  {:else}
    <div class="text-center py-12">
      <p class="text-lg text-base-content/70">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</p>
    </div>
  {/if}
</div>


 –§–∞–π–ª: src/routes/profile/+page.svelte
<script>
  import { onMount } from 'svelte';

  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';
  const courierId = 1;

  let courier = null;
  let deliveries = [];
  let status = 'offline';
  let loading = true;

  onMount(async () => {
    try {
      const [courierRes, deliveriesRes] = await Promise.all([
        fetch(`${API_BASE_URL}/couriers/${courierId}`),  // –î–æ–±–∞–≤—å –≤ –±—ç–∫–µ–Ω–¥: GET /couriers/{id}
        fetch(`${API_BASE_URL}/my-deliveries/${courierId}?history=true`)  // –î–æ–±–∞–≤—å —Ñ–∏–ª—å—Ç—Ä –Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
      ]);

      if (courierRes.ok) {
        courier = await courierRes.json();
        status = courier.status;
      }

      if (deliveriesRes.ok) {
        deliveries = await deliveriesRes.json();
      }
    } catch (e) {
      console.error(e);
    } finally {
      loading = false;
    }
  });

  const updateStatus = async (newStatus) => {
    const res = await fetch(`${API_BASE_URL}/couriers/${courierId}/status`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ status: newStatus })
    });

    if (res.ok) {
      status = newStatus;
      courier.status = newStatus;
    } else {
      alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞');
    }
  };
</script>

<div>
  <div class="flex flex-col md:flex-row gap-6">
    <!-- Avatar -->
    <div class="avatar">
      <div class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center">
        {#if courier?.photo_url}
          <img src={courier.photo_url} alt="–§–æ—Ç–æ –∫—É—Ä—å–µ—Ä–∞" class="w-full h-full object-cover rounded-full" />
        {:else}
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
        {/if}
      </div>
    </div>

    <!-- Info -->
    <div class="flex-1">
      <h2 class="text-2xl font-bold">{courier?.name || '–ö—É—Ä—å–µ—Ä'}</h2>
      <div class="mt-4">
        <div class="flex items-center gap-3">
          <span class="font-medium">–°—Ç–∞—Ç—É—Å:</span>
          <span class={`badge ${status === 'available' ? 'badge-success' : 'badge-error'}`}>
            {status === 'available' ? 'üü¢ –û–Ω–ª–∞–π–Ω' : 'üî¥ –û—Ñ–ª–∞–π–Ω'}
          </span>
          <div class="flex gap-2">
            <button
              class="btn btn-sm btn-success"
              on:click={() => updateStatus('available')}
              disabled={status === 'available'}
            >
              –û–Ω–ª–∞–π–Ω
            </button>
            <button
              class="btn btn-sm btn-error"
              on:click={() => updateStatus('offline')}
              disabled={status === 'offline'}
            >
              –û—Ñ–ª–∞–π–Ω
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-8">
    <h3 class="text-xl font-semibold mb-4">–ò—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç–∞–≤–æ–∫</h3>
    {#if deliveries.length > 0}
      <div class="overflow-x-auto">
        <table class="table table-zebra w-full">
          <thead>
            <tr>
              <th>–ó–∞–∫–∞–∑</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–∞—Ç–∞</th>
            </tr>
          </thead>
          <tbody>
            {#each deliveries as d}
              <tr>
                <td>#{d.order_id}</td>
                <td><span class="badge badge-success">{d.status}</span></td>
                <td>{d.delivered_at || d.assigned_at}</td>
              </tr>
            {/each}
          </tbody>
        </table>
      </div>
    {:else}
      <p class="text-base-content/70">–ù–µ—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–æ–∫</p>
    {/if}
  </div>
</div>


 –§–∞–π–ª: src/stores/courier.js
import { writable } from 'svelte/store';

export const courierId = writable(1); // –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ª–æ–≥–∏–Ω
export const wsConnection = writable(null);
export const availableOrders = writable([]);
export const currentDelivery = writable(null);


 –§–∞–π–ª: src/res.txt
 –§–∞–π–ª: ./components/OrderCard.svelte
<!-- src/components/OrderCard.svelte -->
<script>
    import { courierId } from '../stores/courier.js';

    export let order;
    const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';

    let isAccepting = false; // –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

    const acceptOrder = async () => {
        isAccepting = true;

        // –ñ–¥—ë–º –ø–æ–ª—Å–µ–∫—É–Ω–¥—ã (500–º—Å) —Å –∞–∫—Ç–∏–≤–Ω—ã–º —Å–ø–∏–Ω–Ω–µ—Ä–æ–º
        await new Promise(resolve => setTimeout(resolve, 500));

        try {
            const response = await fetch(`${API_BASE_URL}/assign-delivery/`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    courier_id: $courierId,
                    order_id: order.id
                })
            });

            if (response.ok) {
                // alert('–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç');
                // window.location.reload(); // –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∑–∞–∫–∞–∑–∞');
            }
        } catch (e) {
            alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
        } finally {
            isAccepting = false;
        }
    };
</script>

<div class="border p-4 mb-2 rounded bg-base-100 shadow-sm">
    <p>–ó–∞–∫–∞–∑ #{order.id}</p>
    <p>–¶–µ–Ω–∞: {order.total_price} ‚ÇΩ</p>
    <p>–°—Ç–∞—Ç—É—Å: {order.status}</p>
    <button
        on:click={acceptOrder}
        class="btn btn-success btn-sm transition-all duration-150 active:scale-95 disabled:opacity-50"
        disabled={isAccepting}
        aria-label="–ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑"
    >
        {#if isAccepting}
            <span class="loading loading-spinner loading-xs"></span>
            –ü—Ä–∏–Ω–∏–º–∞—é...
        {:else}
            –ü—Ä–∏–Ω—è—Ç—å
        {/if}
    </button>
</div>


 –§–∞–π–ª: ./lib/assets/favicon.svg
<svg xmlns="http://www.w3.org/2000/svg" width="107" height="128" viewBox="0 0 107 128"><title>svelte-logo</title><path d="M94.157 22.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282 29.608A29.92 29.92 0 0 0 8.764 49.65a31.5 31.5 0 0 0 3.108 20.231 30 30 0 0 0-4.477 11.183 31.9 31.9 0 0 0 5.448 24.116c10.402 14.887 30.942 19.297 45.791 9.835l26.083-16.624A29.92 29.92 0 0 0 98.235 78.35a31.53 31.53 0 0 0-3.105-20.232 30 30 0 0 0 4.474-11.182 31.88 31.88 0 0 0-5.447-24.116" style="fill:#ff3e00"/><path d="M45.817 106.582a20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.503 18 18 0 0 1 .624-2.435l.49-1.498 1.337.981a33.6 33.6 0 0 0 10.203 5.098l.97.294-.09.968a5.85 5.85 0 0 0 1.052 3.878 6.24 6.24 0 0 0 6.695 2.485 5.8 5.8 0 0 0 1.603-.704L69.27 76.28a5.43 5.43 0 0 0 2.45-3.631 5.8 5.8 0 0 0-.987-4.371 6.24 6.24 0 0 0-6.698-2.487 5.7 5.7 0 0 0-1.6.704l-9.953 6.345a19 19 0 0 1-5.296 2.326 20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.502 17.99 17.99 0 0 1 8.13-12.052l26.081-16.623a19 19 0 0 1 5.3-2.329 20.72 20.72 0 0 1 22.237 8.243 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-.624 2.435l-.49 1.498-1.337-.98a33.6 33.6 0 0 0-10.203-5.1l-.97-.294.09-.968a5.86 5.86 0 0 0-1.052-3.878 6.24 6.24 0 0 0-6.696-2.485 5.8 5.8 0 0 0-1.602.704L37.73 51.72a5.42 5.42 0 0 0-2.449 3.63 5.79 5.79 0 0 0 .986 4.372 6.24 6.24 0 0 0 6.698 2.486 5.8 5.8 0 0 0 1.602-.704l9.952-6.342a19 19 0 0 1 5.295-2.328 20.72 20.72 0 0 1 22.237 8.242 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-8.13 12.053l-26.081 16.622a19 19 0 0 1-5.3 2.328" style="fill:#fff"/></svg>

 –§–∞–π–ª: ./lib/index.js
// place files you want to import through the `$lib` alias in this folder.


 –§–∞–π–ª: ./lib/theme.js
// src/lib/theme.js

import { writable } from 'svelte/store';

// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–µ–º—ã (—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å daisyUI)
const THEMES = ['light', 'dark', 'corporate', 'emerald', 'coffee', 'lemonade'];

// –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—É—é —Ç–µ–º—É
export const theme = writable(getStoredTheme());

function getStoredTheme() {
  if (typeof window === 'undefined') return 'lemonade'; // default –¥–ª—è –∞–¥–º–∏–Ω–∫–∏

  const saved = localStorage.getItem('theme');
  if (saved && THEMES.includes(saved)) return saved;

  if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
    return 'dark';
  }

  return 'corporate';
}

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
export function setTheme(newTheme) {
  if (!THEMES.includes(newTheme)) return;
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  theme.set(newTheme);
}

// –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–µ–º—É –±–µ–∑ –º–∏–≥–∞–Ω–∏—è
if (typeof window !== 'undefined') {
  setTheme(getStoredTheme());

  // –°–ª–µ–¥–∏–º –∑–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º–æ–π (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞)
  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
  const handleChange = (e) => {
    const saved = localStorage.getItem('theme');
    if (!saved || saved === 'light' || saved === 'dark') {
      setTheme(e.matches ? 'dark' : 'corporate');
    }
  };
  mediaQuery.addEventListener('change', handleChange);
}


 –§–∞–π–ª: ./routes/+layout.svelte
<script>
  import { base } from '$app/paths';
  import { theme, setTheme } from '$lib/theme.js';
  import { onMount } from 'svelte';
  import '../app.css'; 
  
  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';

  let mounted = false;
  let sidebarOpen = false;
  
  onMount(() => mounted = true);

  const toggleTheme = () => {
    const current = $theme;
    const next = current === 'lemonade' ? 'dark' : 'lemonade';
    setTheme(next);
  };

  const toggleSidebar = () => {
    sidebarOpen = !sidebarOpen;
  };

  // FIX –°—Ç–∞—Ç—É—Å –∫—É—Ä—å–µ—Ä–∞
  let courierStatus = 'offline';
  let courierName = '–ö—É—Ä—å–µ—Ä #1';
  let courierPhoto = null;

  onMount(async () => {
    const res = await fetch(`${API_BASE_URL}/couriers/1`);
    const data = await res.json();
    courierName = data.name;
    courierStatus = data.status;
    courierPhoto = data.photo_url;
  });
</script>

<div class="flex min-h-screen bg-base-100">
  <!-- Mobile Menu Overlay -->
  {#if sidebarOpen}
    <div 
      class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden" 
      on:click={toggleSidebar}
      aria-hidden="true"
    ></div>
  {/if}

  <!-- Sidebar -->
  <aside 
    class="fixed lg:static inset-y-0 left-0 z-50 w-64 bg-base-200 flex flex-col border-r border-base-300 transform transition-transform duration-300 ease-in-out lg:transform-none lg:transition-none {sidebarOpen ? 'translate-x-0' : '-translate-x-full'} lg:translate-x-0"
    role="navigation"
    aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è"
  >
    <!-- Mobile Close Button -->
    <button 
      class="lg:hidden absolute top-4 right-4 btn btn-ghost btn-circle btn-sm"
      on:click={toggleSidebar}
      aria-label="–ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- –®–∞–ø–∫–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º -->
    <div class="p-4 border-b border-base-300 flex items-center gap-3">
      <div class="avatar">
        <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
          {#if courierPhoto}
            <img src={courierPhoto} alt="–§–æ—Ç–æ –∫—É—Ä—å–µ—Ä–∞" class="w-full h-full object-cover rounded-full" />
          {:else}
            <svg xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              />
            </svg>
          {/if}
        </div>
      </div>

      <div class="flex-1 min-w-0">
        <div class="font-semibold text-sm truncate">{courierName}</div>
        <div class="text-xs mt-1">
          <span class={`badge badge-xs ${
            courierStatus === 'available' ? 'badge-success' :
            courierStatus === 'offline' ? 'badge-error' :
            'badge-warning'
          }`}>
            {courierStatus === 'available' ? 'üü¢ –û–Ω–ª–∞–π–Ω' :
             courierStatus === 'offline' ? 'üî¥ –û—Ñ–ª–∞–π–Ω' :
             'üü° –í –ø—É—Ç–∏'}
          </span>
        </div>
      </div>
    </div>

    <!-- –ú–µ–Ω—é -->
    <nav class="flex-1 p-4">
      <ul class="menu bg-base-200 space-y-2">
        <li>
          <a href="{base}/profile" class="flex items-center gap-3 py-3 px-4 rounded-lg hover:bg-base-300 transition-colors">
            <span class="text-lg">üë§</span>
            <span class="text-sm font-medium">–ü—Ä–æ—Ñ–∏–ª—å</span>
          </a>
        </li>
        <li>
          <a href="{base}/orders" class="flex items-center gap-3 py-3 px-4 rounded-lg hover:bg-base-300 transition-colors">
            <span class="text-lg">üì¶</span>
            <span class="text-sm font-medium">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã</span>
          </a>
        </li>
        <li>
          <a href="{base}/my-deliveries" class="flex items-center gap-3 py-3 px-4 rounded-lg hover:bg-base-300 transition-colors">
            <span class="text-lg">üöö</span>
            <span class="text-sm font-medium">–ú–æ–∏ –¥–æ—Å—Ç–∞–≤–∫–∏</span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Main content -->
  <div class="flex-1 flex flex-col min-w-0">
    <!-- Topbar -->
    <header class="navbar bg-base-200 border-b border-base-300 px-4 py-3">
      <div class="flex-1 flex items-center">
        <!-- Mobile Menu Button -->
        <button 
          class="lg:hidden btn btn-ghost btn-circle mr-2"
          on:click={toggleSidebar}
          aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é"
          aria-expanded={sidebarOpen}
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
        
        <div class="flex items-center gap-3">
          <div class="lg:hidden">
            <div class="avatar">
              <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
                {#if courierPhoto}
                  <img src={courierPhoto} alt="–§–æ—Ç–æ –∫—É—Ä—å–µ—Ä–∞" class="w-full h-full object-cover rounded-full" />
                {:else}
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                {/if}
              </div>
            </div>
          </div>
          
          <h1 class="text-lg md:text-xl font-semibold truncate">Courier Dashboard</h1>
        </div>
      </div>
      
      <div class="flex-none flex items-center gap-2">
        <!-- Mobile Status Badge -->
        <div class="lg:hidden">
          <span class={`badge badge-sm ${
            courierStatus === 'available' ? 'badge-success' :
            courierStatus === 'offline' ? 'badge-error' :
            'badge-warning'
          }`}>
            {courierStatus === 'available' ? 'üü¢' :
             courierStatus === 'offline' ? 'üî¥' :
             'üü°'}
          </span>
        </div>
        
        {#if mounted}
          <button 
            class="btn btn-ghost btn-square btn-sm md:btn-md" 
            on:click={toggleTheme} 
            aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"
          >
            {#if $theme === 'dark'}
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
              </svg>
            {:else}
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414z" clip-rule="evenodd" />
              </svg>
            {/if}
          </button>
        {/if}
      </div>
    </header>

    <main class="flex-1 p-4 md:p-6 overflow-auto">
      <slot />
    </main>
  </div>
</div>

<style>
  /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é */
  aside {
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
  }
  
  /* –£–ª—É—á—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
  @media (max-width: 1023px) {
    aside {
      max-width: 85%;
    }
    
    main {
      -webkit-overflow-scrolling: touch;
    }
  }
  
  @media (max-width: 768px) {
    aside {
      max-width: 280px;
    }
  }
</style>


 –§–∞–π–ª: ./routes/+page.svelte
<h1 class="text-2xl font-bold">Courier Service</h1>
<p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é</p>


 –§–∞–π–ª: ./routes/couriers/+page.svelte
<script>
    import { onMount } from 'svelte';
    const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003'; // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è dev

    let couriers = [];

    onMount(async () => {
        const response = await fetch(`${API_BASE_URL}/couriers/`);
        couriers = await response.json();
    });
</script>

<h2 class="text-xl font-bold mb-4">–ö—É—Ä—å–µ—Ä—ã</h2>

<table class="min-w-full border">
    <thead>
        <tr>
            <th class="border px-4 py-2">ID</th>
            <th class="border px-4 py-2">–ò–º—è</th>
            <th class="border px-4 py-2">–°—Ç–∞—Ç—É—Å</th>
            <th class="border px-4 py-2">–¢–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑</th>
        </tr>
    </thead>
    <tbody>
        {#each couriers as courier}
        <tr>
            <td class="border px-4 py-2">{courier.id}</td>
            <td class="border px-4 py-2">{courier.name}</td>
            <td class="border px-4 py-2">{courier.status}</td>
            <td class="border px-4 py-2">{courier.current_order_id || '–ù–µ—Ç'}</td>
        </tr>
        {/each}
    </tbody>
</table>


 –§–∞–π–ª: ./routes/layout.css
@import 'tailwindcss';
@plugin '@tailwindcss/forms';
@plugin '@tailwindcss/typography';


 –§–∞–π–ª: ./routes/my-deliveries/+page.svelte
<!-- src/routes/my-deliveries/+page.svelte -->
<script>
  import { onMount } from 'svelte';

  let deliveries = [];
  const courierId = 1;
  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';

  onMount(async () => {
    const response = await fetch(`${API_BASE_URL}/my-deliveries/${courierId}`);
    deliveries = await response.json();
  });

  const updateStatus = async (deliveryId, newStatus) => {
    const response = await fetch(`${API_BASE_URL}/update-delivery-status/${deliveryId}?status=${newStatus}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ status: newStatus })
    });

    if (response.ok) {
      deliveries = deliveries.map(d =>
        d.id === deliveryId ? { ...d, status: newStatus } : d
      );
    } else {
      alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞');
    }
  };
</script>

<div>
  <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
    </svg>
    –ú–æ–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
  </h2>

  {#if deliveries.length > 0}
    <div class="overflow-x-auto">
      <table class="table table-zebra w-full">
        <thead>
          <tr>
            <th>–ó–∞–∫–∞–∑</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          {#each deliveries as delivery}
            <tr>
              <td>#{delivery.order_id}</td>
              <td>
                <span class={`badge ${
                  delivery.status === 'assigned' ? 'badge-warning' :
                  delivery.status === 'picked_up' ? 'badge-info' :
                  'badge-success'
                }`}>
                  {delivery.status}
                </span>
              </td>
              <td>
                {#if delivery.status === 'assigned'}
                  <button
                    class="btn btn-sm btn-primary"
                    on:click={() => updateStatus(delivery.id, 'picked_up')}
                  >
                    –ó–∞–±—Ä–∞–ª
                  </button>
                {:else if delivery.status === 'picked_up'}
                  <button
                    class="btn btn-sm btn-success"
                    on:click={() => updateStatus(delivery.id, 'delivered')}
                  >
                    –î–æ—Å—Ç–∞–≤–ª–µ–Ω
                  </button>
                {/if}
              </td>
            </tr>
          {/each}
        </tbody>
      </table>
    </div>
  {:else}
    <div class="text-center py-12">
      <p class="text-lg text-base-content/70">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–æ–∫</p>
    </div>
  {/if}
</div>


 –§–∞–π–ª: ./routes/orders/+page.svelte
<!-- src/routes/orders/+page.svelte -->
<script>
  import { onMount, onDestroy } from 'svelte';
  import OrderCard from '../../components/OrderCard.svelte';

  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';
  const WEB_SOCKET_URL = import.meta.env.VITE_WEB_SOCKET_URL || 'ws://localhost:8003';
  const courierId = 1;

  let orders = [];
  let ws = null;

  onMount(async () => {
    // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–∞–∫–∞–∑—ã
    const response = await fetch(`${API_BASE_URL}/available-orders/`);
    orders = await response.json();

    // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WebSocket
    ws = new WebSocket(`${WEB_SOCKET_URL}/ws/${courierId}`);

    ws.onopen = () => console.log('WebSocket connected');
    ws.onclose = () => console.log('WebSocket disconnected');

    ws.onmessage = async (event) => {
      const data = JSON.parse(event.data);

      if (data.type === 'new_order') {
        // üîÅ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º **–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞
        try {
          const orderRes = await fetch(`${API_BASE_URL}/available-orders/`);
          const allOrders = await orderRes.json();

          // –ù–∞—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ—è–≤–∏–≤—à–∏–π—Å—è –∑–∞–∫–∞–∑
          const newOrder = allOrders.find(o => o.id === data.order_id);

          if (newOrder) {
            orders = [newOrder, ...orders.filter(o => o.id !== newOrder.id)];
          }
        } catch (e) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞:', e);
        }
      } else if (data.type === 'order_assigned') {
        // –£–¥–∞–ª—è–µ–º –∑–∞–∫–∞–∑, –µ—Å–ª–∏ –µ–≥–æ –≤–∑—è–ª–∏
        orders = orders.filter(o => o.id !== data.order_id);
      }
    };
  });

  onDestroy(() => {
    if (ws) ws.close();
  });
</script>

<div>
  <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
    </svg>
    –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã
  </h2>

  <div class="mb-4">
    <span class="badge badge-info">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: {orders.length}</span>
  </div>

  {#if orders.length > 0}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {#each orders as order}
        <OrderCard {order} />
      {/each}
    </div>
  {:else}
    <div class="text-center py-12">
      <p class="text-lg text-base-content/70">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</p>
    </div>
  {/if}
</div>


 –§–∞–π–ª: ./routes/profile/+page.svelte
<script>
  import { onMount } from 'svelte';

  const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8003';
  const courierId = 1;

  let courier = null;
  let deliveries = [];
  let status = 'offline';
  let loading = true;

  onMount(async () => {
    try {
      const [courierRes, deliveriesRes] = await Promise.all([
        fetch(`${API_BASE_URL}/couriers/${courierId}`),  // –î–æ–±–∞–≤—å –≤ –±—ç–∫–µ–Ω–¥: GET /couriers/{id}
        fetch(`${API_BASE_URL}/my-deliveries/${courierId}?history=true`)  // –î–æ–±–∞–≤—å —Ñ–∏–ª—å—Ç—Ä –Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
      ]);

      if (courierRes.ok) {
        courier = await courierRes.json();
        status = courier.status;
      }

      if (deliveriesRes.ok) {
        deliveries = await deliveriesRes.json();
      }
    } catch (e) {
      console.error(e);
    } finally {
      loading = false;
    }
  });

  const updateStatus = async (newStatus) => {
    const res = await fetch(`${API_BASE_URL}/couriers/${courierId}/status`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ status: newStatus })
    });

    if (res.ok) {
      status = newStatus;
      courier.status = newStatus;
    } else {
      alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞');
    }
  };
</script>

<div>
  <div class="flex flex-col md:flex-row gap-6">
    <!-- Avatar -->
    <div class="avatar">
      <div class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center">
        {#if courier?.photo_url}
          <img src={courier.photo_url} alt="–§–æ—Ç–æ –∫—É—Ä—å–µ—Ä–∞" class="w-full h-full object-cover rounded-full" />
        {:else}
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
        {/if}
      </div>
    </div>

    <!-- Info -->
    <div class="flex-1">
      <h2 class="text-2xl font-bold">{courier?.name || '–ö—É—Ä—å–µ—Ä'}</h2>
      <div class="mt-4">
        <div class="flex items-center gap-3">
          <span class="font-medium">–°—Ç–∞—Ç—É—Å:</span>
          <span class={`badge ${status === 'available' ? 'badge-success' : 'badge-error'}`}>
            {status === 'available' ? 'üü¢ –û–Ω–ª–∞–π–Ω' : 'üî¥ –û—Ñ–ª–∞–π–Ω'}
          </span>
          <div class="flex gap-2">
            <button
              class="btn btn-sm btn-success"
              on:click={() => updateStatus('available')}
              disabled={status === 'available'}
            >
              –û–Ω–ª–∞–π–Ω
            </button>
            <button
              class="btn btn-sm btn-error"
              on:click={() => updateStatus('offline')}
              disabled={status === 'offline'}
            >
              –û—Ñ–ª–∞–π–Ω
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-8">
    <h3 class="text-xl font-semibold mb-4">–ò—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç–∞–≤–æ–∫</h3>
    {#if deliveries.length > 0}
      <div class="overflow-x-auto">
        <table class="table table-zebra w-full">
          <thead>
            <tr>
              <th>–ó–∞–∫–∞–∑</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–∞—Ç–∞</th>
            </tr>
          </thead>
          <tbody>
            {#each deliveries as d}
              <tr>
                <td>#{d.order_id}</td>
                <td><span class="badge badge-success">{d.status}</span></td>
                <td>{d.delivered_at || d.assigned_at}</td>
              </tr>
            {/each}
          </tbody>
        </table>
      </div>
    {:else}
      <p class="text-base-content/70">–ù–µ—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–æ–∫</p>
    {/if}
  </div>
</div>


 –§–∞–π–ª: ./stores/courier.js
import { writable } from 'svelte/store';

export const courierId = writable(1); // –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ª–æ–≥–∏–Ω
export const wsConnection = writable(null);
export const availableOrders = writable([]);
export const currentDelivery = writable(null);


